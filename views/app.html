<html>
	<head>
		<meta http_equiv=Content-Type content="text/html; charset=utf_8">

                <!-- 接下来引用的js文件是从网上找来的库 -->
		<script src="/socket.io.js"></script>
		<script src="/jquery.min.js"></script>
                <script src="/svg.js"></script>

                <!-- 接下来引用的js文件是自己写的 在 static/javascript 里 -->
                <script src="/javascript/appready.js"></script>

                <script>
                        //这部分用到了ejs模板所以必须写在这里
                        function getUsername(){
                                return "<%=username%>";
                        }
                        function getRoomname(){
                                return "<%=roomname%>";
                        }
                </script>
		<title id="page_title"></title>
                <style type="text/css">
                        div#board{
                                top: 0px;
                                bottom: 0px;
                                left: 0px;
                                right: 0px;
                                width: 100%;
                                height: 100%;
                                position: absolute;
                                z-index: 5;
                        }
                        div.chunk{
                                position:absolute;
                                border-style: solid; border-width: 1px;
                                /*先加上边框方便看*/
                                /*CSS不能使用//注释*/
                                background:#C3BED4;
                        }
                        div#chat{
                                position: absolute;
                                bottom: 0px;
                                left: 0px;
                                z-index: 10;
                        }
                </style>
	</head>
	<body>
                <div id="chat">
                        <h1 id="username"></h1>
                        <div id="text_messages">
                        </div>
                        <div id="text_message_send">
                                <input id="text_message_input"></input>
                                <button id="text_message_button">发送</button>
                        </div>
                </div>
                <script>
                        var socket=io.connect();
                        socket.emit('enter_room',{
                                room: getRoomname(),
                                user: getUsername(),
                        });
                        window.onunload=function(){
                                socket.emit('leave_room',{
                                        room: getRoomname(),
                                        user: getUsername(),
                                });
                        }
                        $("#text_message_button").on("click",sendTextMessage);
                        $("#text_message_input").keydown(function(event){
                                if(event.keyCode==13)//按下回车事件
                                        sendTextMessage();
                        });
                        socket.on("text_message",function(message){
                                addTextMessage(message);
                        });
                        $("#username").text(getUsername()+"@"+getRoomname());
                        $("#page_title").text(getUsername()+"@"+getRoomname());
                </script>
                <!-- 下面这部分是用来测试拖拽和键盘控制移动的 -->
                <div id="board">
                </div>

        </body>
</html>
